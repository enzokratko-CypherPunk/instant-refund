<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>Vault V2 - 06:17:32</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen flex items-center justify-center">
    <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700 w-96 shadow-2xl">
        <h1 class="text-xl font-bold mb-2">Merchant Vault</h1>
        <p class="text-[10px] text-slate-500 mb-6 uppercase tracking-widest">Updated at: 06:17:32</p>
        
        <div class="bg-black/20 p-4 rounded-xl mb-6 border border-slate-700">
            <p class="text-[10px] text-slate-400 uppercase">Available Liquidity</p>
            <div id="vaultBalance" class="text-2xl font-mono text-blue-400 font-bold">Checking...</div>
        </div>

        <button onclick="process()" id="btn" class="w-full bg-blue-600 p-4 rounded-xl font-bold">Execute Refund</button>
        <div id="status" class="mt-4 text-[10px] font-mono text-slate-500 break-all"></div>
    </div>

    <script>
        const addr = 'kaspa:qpkfkghmv8cmyc93u3jpvefurse3qrfu7zmkd5em5g2955jjz66uwg0m4a4qc';
        async function getBal() {
            try {
                const r = await fetch('https://api.kaspa.org/addresses/' + addr + '/balance');
                const d = await r.json();
                document.getElementById('vaultBalance').innerText = (d.balance / 100000000).toLocaleString() + ' KAS';
            } catch(e) { document.getElementById('vaultBalance').innerText = 'Sync Error'; }
        }
        async function process() {
            const b = document.getElementById('btn');
            b.innerText = 'Signing...';
            try {
                const r = await fetch('/v1/refunds/instant', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({amount: 10000000, recipient_address: 'kaspa:qz8zmn0w7pngsqu9dsn86wej4fxyukjqqec3a85ses7e3d84eehvc6udm9rax', merchant_id: 'V2-TEST'})
                });
                const d = await r.json();
                document.getElementById('status').innerText = 'Signed: ' + d.signed_hex.substring(0,40) + '...';
                b.innerText = 'Success';
                getBal();
            } catch(e) { b.innerText = 'Error'; }
        }
        getBal();
    </script>
</body>
</html>


